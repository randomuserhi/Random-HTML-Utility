<!DOCTYPE html>
<html>
	<head>
		<script type="text/x-rhu-config">
		RHU.config = {
			modules: ["macro", "event", "websockets", "rest", "weak", "file"],
			extensions: ["rhu/layout", "rhu/anim", "rhu/blankImg", "rhu/localisation", "rhu/bezier", "rhu/markdown"],
			/*includes: {
				"file:///D:/bruh": ["epic"],
				"": ["woah"]
			}*/
		};
		</script>
		<script src="RHU/RHU.js"></script>
		<!--<script src="tests/RHU.js"></script>-->
	</head>
	<body>
		<rhu-macro rhu-type="layout"></rhu-macro>

		<script type="text/javascript">
			RHU.module({ hard: ["RHU.Localisation"], trace: new Error() }, function(e) {
				RHU.Localisation.setSchema({"woah": {"innerHTML":"craze"}});
			});

			RHU.module({ module: "Testing weak module", trace: new Error(), hard: ["RHU.WeakCollection", "RHU.WeakRefMap"] }, function()
			{
				window.testWeakCollection = new RHU.WeakCollection();
				window.testWeakRefMap = new RHU.WeakRefMap();
				function a()
				{
				    let b = {};
				    testWeakCollection.add(b);
				    testWeakRefMap.set("crazy", b);
				}
				a();
			});

			RHU.module({ module: "internal", trace: new Error(), hard: ["RHU.Macro", "RHU.Localisation", "RHU.Layout"] }, function(e) {
				let willGetUpdated = document.createElement("div");
				willGetUpdated.setAttribute("rhu-macro", "woah");

				let test = function()
				{
					window.layout = this;

					RHU.Layout.call(this);

					this.setLayout(document.createMacro("woah"));
					let text = document.createElement("div");
					text.innerHTML = "BOOMER";
					this.bind(text, "test", {floating: true});
				}
				RHU.inherit(test, RHU.Layout);
				new RHU.Macro(test, "layout", "", { element: `<div style="width: 100%; height: 100%"></div>` });

				new RHU.Macro(function() {
					RHU.Localisation.addEventListener("change", (e) => {
						this.nice.innerHTML = e["woah"].innerHTML;
					});
					if (RHU.exists(RHU.Localisation.schema))
						this.nice.innerHTML = RHU.Localisation.schema["woah"].innerHTML;
				}, "asd",
					/*HTML*/`<div rhu-id="nice"></div><div rhu-loc="woah">boomer</div><!--woah-->crazy`,
					{ element: /*HTML*/`<div></div>`, floating: true });

				new RHU.Macro(function() {}, "woah",
					/*HTML*/`<div rhu-id="test"></div>`,
					{ element: /*HTML*/`<div></div>` });
			});
		</script>
	</body>
</html>